#pragma once
#include "Spline.h"
#include "SpaceObject.h"

class FEnemy : public FSpaceObject
{
private:
    olc::vf2d OriginPosition;
    olc::vf2d SavedPosition;

    float Angle = 0.0f;
    float Marker = 0.0f;
   
    std::vector<FSpline> Paths;

    olc::Decal* Decal;

public:
    enum EEstate {Start, Formation, Selected, Snake};
    EEstate Estate;
    
    FEnemy(const olc::vf2d& InSize, const olc::vf2d& InPosition, const olc::vf2d& InVelocity);

    //--------------------------------------------------------------------------------------------------------------
    const olc::vf2d& GetOriginPosition() const;

    //--------------------------------------------------------------------------------------------------------------
    void SetOriginPosition(const olc::vf2d& NewPosition);

    //--------------------------------------------------------------------------------------------------------------
    const olc::vf2d& GetSavedPosition() const;

    //--------------------------------------------------------------------------------------------------------------
    void SetSavedPosition(const olc::vf2d& NewPosition);

    //--------------------------------------------------------------------------------------------------------------
    EEstate GetState() const;

    //--------------------------------------------------------------------------------------------------------------
    void SetState(EEstate NewState);

    //--------------------------------------------------------------------------------------------------------------
    float GetMarker() const;

    //--------------------------------------------------------------------------------------------------------------
    void SetMarker(const float NewMarker);
    
    //--------------------------------------------------------------------------------------------------------------
    void UpdateMarker(float NewMarker);

    //-------------------------------------------------------------------------------------------------------------
    void CalculateFormationPath(float Timer);
    
    //---------------------------------------------------------------------------------------------------------------
    void FollowFormationPath();

    //---------------------------------------------------------------------------------------------------------------
    void ActivatePath(float Timer, int PathSelector);

    //---------------------------------------------------------------------------------------------------------------
    void CalculateAngle(const FSpline& PathToCalculate);

    //---------------------------------------------------------------------------------------------------------------
    float GetAngle() const;

    //----------------------------------------------------------------------------------------------------------------
    olc::Decal* GetDecal() const;

    //----------------------------------------------------------------------------------------------------------------
    void SetDecal( olc::Decal* NewDecal);
};
